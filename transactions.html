---
title: Transactions
layout: default
---
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.6), see www.w3.org">
    <title></title>
    <style type="text/css">
li.c1 {list-style: none}
    </style>
  </head>
  <body>
    <p></p>
    <ul>
      <li>
        <a href="#Introduction">Introduction</a>
      </li>
      <li>
        <a href="#Record_IDs">Record IDs</a>
      </li>
      <li>
        <a href="#Fail-over">Fail-over</a>
      </li>
      <li>
        <a href="#Auto-recovery">Auto-recovery</a>
      </li>
      <li>
        <a href="#Transaction_types">Transaction types</a>
      </li>
      <li class="c1">
        <ul>
          <li>
            <a href="#No_Transaction">No Transaction</a>
          </li>
          <li>
            <a href="#Optimistic_Transaction">Optimistic Transaction</a>
          </li>
          <li>
            <a href="#Pessimistic_Transaction">Pessimistic Transaction</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#Improve_reliability_in_case_of_hw/sw_crash">Improve reliability in case of hw/sw crash</a>
      </li>
      <li>
        <a href="#Tuning">Tuning</a>
      </li>
    </ul>
    <h2>
      <a name="Introduction" id="Introduction"></a>Introduction<a href="#Introduction" class="section_anchor"></a>
    </h2>
    <p>
      OrientDB is an <a href="http://en.wikipedia.org/wiki/ACID" rel="nofollow">ACID</a> compliant DBMS. By default no transaction is opened when you use Orient.
    </p>
    <p>
      In some situations transactions can improve performance, typically in the client/server scenario. If you use an Optimistic Transaction, the OrientDB engine optimizes the network transfer between the client and server, saving both CPU and bandwidth.
    </p>
    <h2>
      <a name="Record_IDs" id="Record_IDs"></a>Record IDs<a href="#Record_IDs" class="section_anchor"></a>
    </h2>
    <p>
      OrientDB uses temporary <a href="concepts.html#RecordID">RecordID</a>s with transaction as scope that will be transformed to finals once the transactions is successfully committed to the database. This avoid to ask for a free slot every time a client creates a record.
    </p>
    <h2>
      <a name="Fail-over" id="Fail-over"></a>Fail-over<a href="#Fail-over" class="section_anchor"></a>
    </h2>
    <p>
      An Orient instance can fail for several reasons:
    </p>
    <ul>
      <li>HW problems, such as loss of power or disk error
      </li>
      <li>SW problems, such as a Operating System crash
      </li>
      <li>Application problem, such as a bug that crashes your application that is connected to the Orient engine.
      </li>
    </ul>
    <p>
      You can use the OrientDB engine directly in the same process of your application. This gives superior performance due to the lac of inter-process communication. In this case, should your application crash (for any reason), the OrientDB Engine also crashes.
    </p>
    <p>
      If you're using an OrientDB Server connected remotely, if your application crashes the engine continue to work, but any pending transaction owned by the client will be rolled back.
    </p>
    <h2>
      <a name="Auto-recovery" id="Auto-recovery"></a>Auto-recovery<a href="#Auto-recovery" class="section_anchor"></a>
    </h2>
    <p>
      At start-up the OrientDB Engine checks to if it is restarting from a crash. In this case, the auto-recovery phase starts which rolls back all pending transactions.
    </p>
    <h2>
      <a name="Transaction_types" id="Transaction_types"></a>Transaction types<a href="#Transaction_types" class="section_anchor"></a>
    </h2>
    <h3>
      <a name="No_Transaction" id="No_Transaction"></a>No Transaction<a href="#No_Transaction" class="section_anchor"></a>
    </h3>
    <p>
      Default mode. Each operation is executed instantly.
    </p>
    <p>
      Calls to <tt>begin()</tt>, <tt>commit()</tt> and <tt>rollback()</tt> have no effect.
    </p>
    <h3>
      <a name="Optimistic_Transaction" id="Optimistic_Transaction"></a>Optimistic Transaction<a href="#Optimistic_Transaction" class="section_anchor"></a>
    </h3>
    <p>
      This mode uses the well known <a href="http://en.wikipedia.org/wiki/Multiversion_concurrency_control" rel="nofollow">Multi Version Control System (MVCC)</a> by allowing multiple reads and writes on the same records. The integrity check is made on commit. If the record has been saved by another transaction in the interim, then a OConcurrentModificationException exception will be throw. The application can choose either to repeat the transaction or abort it.
    </p>
    <pre class="prettyprint">
db.open("remote:localhost:7777/petshop");

try{
  db.begin(TXTYPE.OPTIMISTIC);
  ...
  // WRITE HERE YOUR TRANSACTION LOGIC
  ...
  db.commit();
}catch( Exception e ){
  db.rollback();
} finally{
  db.close();
}
</pre>
    <p>
      In Optimistic transaction new records take temporary <a href="concepts.html#RecordID">RecordID</a>s to avoid to ask to the server a new <a href="concepts.html#RecordID">RecordID</a> every time. Temporary <a href="concepts.html#RecordID">RecordID</a>s have Cluster Id -1 and Cluster Position &lt; -1. When a new transaction begun the counter is reset to -1:-2. So if you create 3 new records you'll have:
    </p>
    <ul>
      <li>-1:-2
      </li>
      <li>-1:-3
      </li>
      <li>-1:-4
      </li>
    </ul>
    <p>
      At commit time these record temporary <a href="concepts.html#RecordID">RecordID</a>s will be converted in the final ones.
    </p>
    <h3>
      <a name="Pessimistic_Transaction" id="Pessimistic_Transaction"></a>Pessimistic Transaction<a href="#Pessimistic_Transaction" class="section_anchor"></a>
    </h3>
    <p>
      This mode is not supported yet by the engine. Track <a href="http://code.google.com/p/orient/issues/detail?id=12" rel="nofollow">issue</a> for more information.
    </p>
    <h2>
      <a name="Improve_reliability_in_case_of_hw/sw_crash"></a>Improve reliability in case of hw/sw crash<a href="#Improve_reliability_in_case_of_hw/sw_crash" class="section_anchor"></a>
    </h2>
    <p>
      By default OrientDB, uses the Operating System's capabilities to speed up access to the underlying file system.
    </p>
    <p>
      If you have a reliable IO system such as RAID hardware device this is not a problem. But if you run OrientDB on top of non-reliable HW (no RAID controller) or you want to reduce at the minimum database integrity problems on improvise crash of the Server machine then enable a synch for each transaction log operation.
    </p>
    <p>
      Via JVM configuration:
    </p>
    <pre class="prettyprint">
java ... -Dtx.log.synch=true ...
</pre>
    <p>
      or via API:
    </p>
    <pre class="prettyprint">
OGlobalConfiguration.TX_LOG_SYNCH.setValue(true);
</pre>
    <p>
      You can also execute a synch against every single database file once transaction commit is completed.
    </p>
    <p>
      Via JVM configuration:
    </p>
    <pre class="prettyprint">
java ... -Dtx.commit.synch=true ...
</pre>
    <p>
      or via API:
    </p>
    <pre class="prettyprint">
OGlobalConfiguration.TX_COMMIT_SYNCH.setValue(true);
</pre>
    <h2>
      <a name="Tuning" id="Tuning"></a>Tuning<a href="#Tuning" class="section_anchor"></a>
    </h2>
    <p>
      For further information look at <a href="performance_tuning.html#Wise_use_of_transactions">Transaction tuning</a> to know more.
    </p>
  </body>
</html>
