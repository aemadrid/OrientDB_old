---
title: Import from RDBMS
layout: default
---
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.6), see www.w3.org">
    <title></title>
  </head>
  <body>
    <p>
      OrientDB supports a subset of SQL, so importing a database created as "Relational" is straightforward.
    </p>
    <p>
      For the sake of simplicity consider your Relational database having just these two tables:
    </p>
    <ul>
      <li>POST
      </li>
      <li>COMMENT
      </li>
    </ul>
    <p>
      Where the relationship is between Post and comment as One-2-Many.
    </p>
    <pre class="prettyprint">
TABLE POST:
+----+----------------+
| id | title          |
+----+----------------+
| 10 | NoSQL movement |
| 20 | New OrientDB   |
+----+----------------+

TABLE COMMENT:
+----+--------+--------------+
| id | postId | text         |
+----+--------+--------------+
|  0 |   10   | First        |
|  1 |   10   | Second       |
| 21 |   10   | Another      |
| 41 |   20   | First again  |
| 82 |   20   | Second Again |
+----+--------+--------------+
</pre>
    <p>
      Follow these steps:
    </p>
    <h3>
      <a name="Export_your_Relational_Database" id="Export_your_Relational_Database"></a>Export your Relational Database<a href="#Export_your_Relational_Database" class="section_anchor"></a>
    </h3>
    <p>
      Most of Relational DBMSs provide a way to export a database in SQL format. What you need is a text file containing the SQL INSERT commands to recreate the database from scratch. Take a look to the documentation of your RDBMS provider.
    </p>
    <h3>
      <a name="Create_the_class,_one_for_tables"></a>Create the class, one for tables<a href="#Create_the_class,_one_for_tables" class="section_anchor"></a>
    </h3>
    <p>
      You can follow 2 strategies to create the equivalent database in OrientDB. To create and edit the schema use the <a href="orient_db_studio.html">OrientDB Studio visual tool</a> or the <a href="console_commands.html">Console</a>.
    </p>
    <h4>
      <a name="Classic_Relational_Database" id="Classic_Relational_Database"></a>Classic Relational Database<a href="#Classic_Relational_Database" class="section_anchor"></a>
    </h4>
    <p>
      Since the Relational Model hasn't Object Oriented concepts you can create a class per table.
    </p>
    <pre class="prettyprint">
&gt; CREATE CLASS POST
&gt; CREATE CLASS COMMENT
</pre>
    <h4>
      <a name="Pseudo_Object_Oriented_database" id="Pseudo_Object_Oriented_database"></a>Pseudo Object Oriented database<a href="#Pseudo_Object_Oriented_database" class="section_anchor"></a>
    </h4>
    <p>
      This is the case when your Relational database was created using a OR-Mapping tool like <a href="http://www.hibernate.org" rel="nofollow">Hibernate</a> or <a href="http://www.datanucleus.org" rel="nofollow">Data Nucleus</a> (JDO).
    </p>
    <p>
      In this case you have to re-build the original Object Oriented structure directly in OrientDB using the Object Oriented capabilities of OrientDB.
    </p>
    <h3>
      <a name="Import_the_records" id="Import_the_records"></a>Import the records<a href="#Import_the_records" class="section_anchor"></a>
    </h3>
    <p>
      Modify the exported script generated by the RDBMS leaving only the INSERT statements:
    </p>
    <pre class="prettyprint">
INSERT INTO POST (id, title) VALUES( 10, 'NoSQL movement' );
INSERT INTO POST (id, title) VALUES( 20, 'New OrientDB' );

INSERT INTO COMMENT (id, postId, text) VALUES( 0, 10, 'First' );
INSERT INTO COMMENT (id, postId, text) VALUES( 1, 10, 'Second' );
INSERT INTO COMMENT (id, postId, text) VALUES( 21, 10, 'Another' );
INSERT INTO COMMENT (id, postId, text) VALUES( 41, 20, 'First again' );
INSERT INTO COMMENT (id, postId, text) VALUES( 82, 20, 'Second Again' );
</pre>
    <p>
      Execute it by using the console giving the text file just created as first argument, in this case "database.sql":
    </p>
    <pre class="prettyprint">
&gt; console.sh database.sql
</pre>
    <h3>
      <a name="Create_links" id="Create_links"></a>Create links<a href="#Create_links" class="section_anchor"></a>
    </h3>
    <p>
      At this point you need to create links as relationships in OrientDB. The <a href="sql_create_link.html">Create Link command</a> creates links between two or more records of type Document. In facts in the Relational world relationships are resolved as foreign keys.
    </p>
    <p>
      Using OrientDB, instead, you have direct relationship as in your object model. So the navigation is from <i>Post</i> to <i>Comment</i> and not viceversa as for Relational model. For this reason you need to create a link as <strong>INVERSE</strong>.
    </p>
    <p>
      Execute:
    </p>
    <pre class="prettyprint">
CREATE LINK comments TYPE linkset FROM comment.postId To post.id INVERSE
</pre>
    <h3>
      <a name="Remove_old_constraints" id="Remove_old_constraints"></a>Remove old constraints<a href="#Remove_old_constraints" class="section_anchor"></a>
    </h3>
    <p>
      Now you've direct links the field 'postId' has no more sense, so remove it:
    </p>
    <pre class="prettyprint">
UPDATE comment REMOVE postId
</pre>
    <h3>
      <a name="Enjoy" id="Enjoy"></a>Enjoy<a href="#Enjoy" class="section_anchor"></a>
    </h3>
    <p>
      That's all. Now you've a OrientDB database where relationships are direct without JOINS.
    </p>
    <p>
      Now enjoy with your new document-graph database and the following queries:
    </p>
    <p>
      Select all the post with comments:
    </p>
    <pre class="prettyprint">
select * from post where comments.size() &gt; 0
</pre>
    <p>
      Select all the posts where comments contain the word 'flame' in the text property (before as column):
    </p>
    <pre class="prettyprint">
select * from post where comments contains ( text like '%flame%' )
</pre>
    <p>
      Select all the posts commented today. In this case we're assuming a property "date" is present in Comment class:
    </p>
    <pre class="prettyprint">
select * from post where comments contains ( date &gt; '2011-04-14 00:00:00' )
</pre>
    <p>
      To know more about other SQL commands look at <a href="sql.html">SQL commands</a>.
    </p>
    <p>
      This is a command of the Orient console. To know all the commands go to <a href="console_commands.html">Console commands</a>.
    </p>
  </body>
</html>
